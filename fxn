#!/bin/bash


############################
#     Packages to Install
############################
echo "Cleaning and installing needed packages, please wait.... !!!!" ;
apt clean ;
apt autoclean ;
sed -i '/^\([^#].*main\)*$/s/main/& contrib non-free/' /etc/apt/sources.list ;
apt-get update && apt-get upgrade -y -qq ;
apt-get install sudo \
xz-utils \
wget \
unzip \
xserver-xorg \
xinit \
fluxbox \
lxpolkit \
pcmanfm \
udevil \
xcompmgr \
plank \
volumeicon-alsa \
pulseaudio \
pavucontrol \
vlc \
slim \
firmware-linux-nonfree \
firmware-misc-nonfree \
firmware-realtek \
firmware-atheros \
firmware-iwlwifi \
firmware-brcm80211 \
firmware-amd-graphics \
firmware-b43-installer \
firmware-b43legacy-installer \
network-manager-gnome -y -qq >/dev/null ;
apt-get install --no-install-recommends synaptic \
gparted \
gufw \
featherpad \
lxappearance \
viewnior \
sakura \
xpaint \
scrot \
xpdf \
firefox-esr \
mate-power-manager \
xarchiver -y -qq >/dev/null ;
usermod -aG sudo fluxuan ;
sed -i 's/false/true/' /etc/NetworkManager/NetworkManager.conf ;
rm -rf /usr/share/fluxbox/styles ;
sed -i 's/Devuan/Fluxuan/' /etc/motd ;
sed -i 's/Devuan/Fluxuan/' /etc/issue ;
sed -i 's/Devuan/Fluxuan/' /etc/issue.net ;
sed -i 's/Devuan/Fluxuan/' /etc/os-release ;
sed -i 's/Debian/Fluxuan/' /etc/motd ;
sed -i 's/Debian/Fluxuan/' /etc/issue ;
sed -i 's/Debian/Fluxuan/' /etc/issue.net ;
sed -i 's/Debian/Fluxuan/' /etc/os-release ;
echo "vm.swappiness = 10" >>  /etc/sysctl.d/fluxuanctl.conf ;
echo "vm.dirty_ratio = 40" >>  /etc/sysctl.d/fluxuanctl.conf ;
echo "vm.dirty_background_ratio = 20" >>  /etc/sysctl.d/fluxuanctl.conf ;
echo "vm.vfs_cache_pressure = 50" >> /etc/sysctl.d/fluxuanctl.conf ;
touch /etc/apt/apt.conf.d/80updatehook ;
echo "DPkg::Post-Invoke {"/usr/bin/fxmenuupdate";};" >> /etc/apt/apt.conf.d/80updatehook ;
rm -rf /usr/share/desktop-base ;
cd /etc/skel/ ;
curl -LJO raw.githubusercontent.com/crentz/fx/main/fxi.tar.xz ;
tar -xf fxi.tar.xz ;
rm -rf fxi.tar.xz ;
chmod +x Byef fxw fbscreensize fxmenuupdate ;
mv fxslim /usr/share/slim/themes/;
sed -i 's/desktop-slim-theme/fxslim/' /etc/slim.conf ;
sed -i 's/#default_user        simone/default_user fluxuan/' /etc/slim.conf ;
sed -i 's/#auto_login          no/auto_login yes/' /etc/slim.conf ;
mv fbscreensize /usr/bin/ ;
mv fxmenuupdate /usr/bin/ ;
mv Byef /usr/bin/ ;
mv fxw /usr/bin/ ;
mv Mythos /usr/share/themes/ ;
mv Gruvbox /usr/share/icons/ ;
mv 40-libinput.conf /etc/X11/xorg.conf.d/ ;
mv fx /usr/share/ ;
mv 8flow /usr/share/plank/themes/ ;
rm -rf /boot/grub/splash.png ;
sed -i 's/GRUB_TIMEOUT=5/GRUB_TIMEOUT=3/' /etc/default/grub ;
sed -i 's/GRUB_THEME/#GRUB_THEME/' /etc/default/grub ;
sed -i 's/Devuan/Fluxuan/' /etc/default/grub ;
sed -i 's/Debian/Fluxuan/' /etc/default/grub ;
cp /usr/share/fx/splash.png /boot/grub/ ;
update-grub ;
mv start.wav /usr/share/sounds/ ;
apt clean ;
apt autoclean ;
apt update ;
cp -R .config/ .fluxbox/ .gtkrc-2.0 .fehbg .profile .bashrc /home/fluxuan/ ;
cd ;
rm -rf fxn ;
chown -R fluxuan:fluxuan /home/fluxuan/ ;
echo "####################################################" ;
echo "Packages finished and installed succesfully. Enjoy !" ;
echo "####################################################" ;
