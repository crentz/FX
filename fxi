#!/bin/bash
apt clean
apt autoclean
sed -i '/^\([^#].*main\)*$/s/main/& contrib non-free non-free-firmware/' /etc/apt/sources.list

find /usr/share/doc \( -name "*.gz" -o -name "*.pdf" -o -name "*.tex" \) -type f -exec rm -rf {} +
rm -rf /usr/share/man/* /usr/share/groff/* /usr/share/info/* /usr/share/lintian/* /usr/share/linda/* /var/cache/man/*
cat <<EOF > /etc/dpkg/dpkg.cfg.d/01_nodoc
path-exclude /usr/share/doc/*
# we need to keep copyright files for legal reasons
path-include /usr/share/doc/*/copyright
# if you also want to remove the man pages uncomment the next line
path-exclude /usr/share/man/*
path-exclude /usr/share/groff/*
path-exclude /usr/share/info/*
# lintian stuff is small, but really unnecessary
path-exclude /usr/share/lintian/*
path-exclude /usr/share/linda/*
EOF
apt-get update
apt-get install sudo xz-utils whiptail wget unzip xserver-xorg xinit net-tools isc-dhcp-client fluxbox lxpolkit thunar thunar-archive-plugin udevil volumeicon-alsa alsa-utils slim blackbird-gtk-theme network-manager-gnome conky qutebrowser firmware-linux-nonfree firmware-misc-nonfree firmware-realtek firmware-atheros firmware-iwlwifi firmware-brcm80211 firmware-amd-graphics firmware-b43-installer firmware-b43legacy-installer apulse arandr -y -qq
apt-get install --no-install-recommends synaptic gparted featherpad squashfs-tools nano lxappearance sakura scrot mate-power-manager xarchiver -y -qq
rm -rf /usr/share/fluxbox/styles
sed -i 's/Devuan/Fluxuan/g; s/Debian/Fluxuan/g; s/devuan/Fluxuan/g' /etc/motd /etc/issue /etc/issue.net /etc/os-release /usr/lib/os-release
curl -LJO raw.githubusercontent.com/crentz/fx/main/mmaker.deb
apt-get install ./mmaker.deb -y -qq
rm -rf mmaker.deb
cd /etc/skel
curl -LJO raw.githubusercontent.com/crentz/fx/main/fx.tar.xz
tar -xf fx.tar.xz
rm -rf fx.tar.xz
chmod +x fxmenuupdate fwel widevine fluxuan-installer
mv fxmenuupdate fwel widevine fluxuan-installer /usr/bin/
mv fxslim /usr/share/slim/themes/
mv fx /usr/share/
echo "fluxuan ALL=(ALL) NOPASSWD: /usr/bin/fluxuan-installer" >> /etc/sudoers
mv 40-libinput.conf /etc/X11/xorg.conf.d/
mv slim.conf /etc/
touch /etc/apt/apt.conf.d/80updatehook
echo "DPkg::Post-Invoke {"fxmenuupdate";};" >> /etc/apt/apt.conf.d/80updatehook
cd
rm -rf fxi
find /usr/share/doc \( -name "*.gz" -o -name "*.pdf" -o -name "*.tex" \) -type f -exec rm -rf {} +
find /usr/share/locale -mindepth 1 -maxdepth 1 -type d ! -name 'en*' -exec rm -rf {} \;
rm -rf /usr/share/man/* /usr/share/groff/* /usr/share/info/* /usr/share/lintian/* /usr/share/linda/* /var/cache/man/*
apt-get clean
apt-get autoclean
apt-get autoremove
rm -rf /tmp/*
rm -rf /var/tmp/*
rm -rf /var/log/*.gz
echo "Everything installed / All finished !!!"
